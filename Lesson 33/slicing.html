<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Web And HTML5 APIs</title>
    <style>

        #byte_content{
            margin: 5px 0;
            max-height: 100px;
            overflow-y: auto;
            overflow-x: hidden
        }
         #byte_range {margin-top: 5px}

    </style>
   
</head>
<body>

                     <!--Slicing a File--> 
                
         <input type="file" id="files" name="file" /> Read bytes;
         <span class="readBytesButtons">
             <button data-startbytes="0" data-endbytes="4">1-5</button>
             <button data-startbytes="5" data-endbytes="14">6-15</button>
             <button data-startbytes="6" data-endbytes="6">7-8</button>
             <button>entire file</button>
         </span>
         <div id="byte_range"></div>
         <div id="byte_content"></div>

   

    <script>

        function readBlob(opt_startByte, opt_stopByte){
            var files = document.getElementById('files').files
            
             if(!files.length) {
                 alert('Please select a file')
                 return

            }

            var file = files[0]
            var start = parseInt(opt_startByte) || 0
            var stop = parseInt(opt_stopByte) || file.size - 1
            var reader = new FileReader()

â€‹           // if we use onloadend, we need to check the ready state

            reader.onloadend = (e) => {
                if(e.target.readyState == fileReader.DONE) { //done == 2
                
                document.getElementById('byte_content').textContent = e.target.result
               
                document.getElementById('byte_range').textContent = 
                ['Read bytes', start + 1, ' - ', stop + 1,' of ', file.size, 'byte-file'].join('')

                }

            }

            var blob = file.slice(start, stop + 1)

            reader.readAsBinaryString(blob)

        }
        
        document.querySelector('.readyBytesButtons').addEventListener('click', (e) => {

            if(e.target.tagName.toLowerCase() === 'button') {

                var startByte = e.target.getAttribute('data-startbyte')
                var endByte = e.target.getAttribute('data-endbyte')

                readBlob(startByte, endByte), false

            }

        })

    </script>
    
</body>
</html>